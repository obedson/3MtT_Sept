<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Product Details</title>
    <!-- Firebase SDKs -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAT0sl_f26UP7MwIVxWJMvaz52_HodsSYY",
            authDomain: "mtt-d130b.firebaseapp.com",
            projectId: "mtt-d130b",
            storageBucket: "mtt-d130b.appspot.com",
            messagingSenderId: "103379427385",
            appId: "1:103379427385:web:672ee6ff76784954082de8",
            measurementId: "G-YXQCJLM1T9"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Function to load product data from Firestore
        async function loadFirebaseData() {
            const productDetailsDiv = document.getElementById('productDetails');
            productDetailsDiv.innerHTML = ''; // Clear previous content
            
            try {
                const querySnapshot = await getDocs(collection(db, 'products'));
                if (querySnapshot.empty) {
                    productDetailsDiv.innerText = 'No data found in Firebase.';
                    return;
                }

                querySnapshot.forEach((doc) => {
                    const product = doc.data();
                    displayFirebaseData(product);
                });
            } catch (error) {
                console.error('Error fetching data from Firebase:', error);
                productDetailsDiv.innerText = 'Error loading data from Firebase.';
            }
        }

        // Function to display product details
        function displayFirebaseData(product) {
            const productDetailsDiv = document.getElementById('productDetails');
            const productInfo = `
                <img src="${product.imageUrl}" alt="Product Image" style="max-width: 300px; height: auto;">
                <p><strong>Description:</strong> ${product.description}</p>
                <p><strong>Price:</strong> ${product.price}</p>
                <button onclick="redirectToWhatsApp('${product.whatsappLink}')">Buy Now</button>
                <hr>
            `;
            productDetailsDiv.innerHTML += productInfo;
        }

        // Function to redirect to the seller's WhatsApp
        function redirectToWhatsApp(whatsappLink) {
            window.open(whatsappLink, '_blank');
        }

        // Automatically load data when the page loads
        window.onload = function() {
            loadFirebaseData();
        };
    </script>
</head>
<body>
    <h2>Product Details</h2>
    <div id="productDetails"></div>
</body>
</html>
